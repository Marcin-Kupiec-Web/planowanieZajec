<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	template="/WEB-INF/templates/BasicTemplate.html">
	<ui:define name="content">
	<h:outputScript library="js" name="charts/chartsStart.js?73" />
<p:outputPanel deferred="true" >
	<p:panel style=";width:95%;margin:auto;margin-top:10px;border:none" class="bg-white shadow" 
	rendered="#{logowanie.poziomUprawnien le 4}">
	<div>
		<h:form >
				<p:panelGrid id="pgOs" layout="grid" columns="6" class="shadow" style="width:90%!important;text-align:right;margin:auto">
					<p:outputLabel>Komp.</p:outputLabel>
						    <p:selectOneMenu id="kompania" value="#{oddzialy.kompania}" lazy="true" style="width:80%">
					    		<p:ajax event="change" listener="#{oddzialy.changeKompania}" update="pgOs,formSluchacze" />
					    		<f:selectItem />
					        	 <f:selectItems value="#{oddzialy.kompanieListNazwa}"/> 
					  	  </p:selectOneMenu>
					 <p:outputLabel>Plut.</p:outputLabel>
							<p:selectOneMenu  value="#{oddzialy.pluton}" lazy="true" style="width:80%">
							    <p:ajax event="change" listener="#{oddzialy.changePluton}" update="pgOs,formSluchacze" />
							    	<f:selectItem />
							         <f:selectItems value="#{oddzialy.plutonListNazwa}"/> 
							 </p:selectOneMenu>
					   <p:outputLabel>Szkol.</p:outputLabel>
						    <p:selectOneMenu value="#{oddzialy.szkolenie}" lazy="true" style="width:80%">
						    <p:ajax event="change" listener="#{oddzialy.changeSzkolenie()}" update="pgOs,formSluchacze" />
						   		 <f:selectItem />
						         <f:selectItems value="#{oddzialy.plutonListSzkolenie}"/>
						    </p:selectOneMenu>
						    <h:outputLabel>Imię: </h:outputLabel>
				   				<p:inputText value="#{oddzialy.imieSluchacz}" style="width:95%"/>
				   			 <h:outputLabel>Nazwisko: </h:outputLabel>
				   				<p:inputText value="#{oddzialy.nazwiskoSluchacz}" style="width:95%"/>	
				   			<h:outputLabel>Kadrowy: </h:outputLabel>
				   				<p:inputText value="#{oddzialy.kadrowySluchacz}" style="width:95%"/>	
				   			<h:outputLabel>Jednostka: </h:outputLabel>
				   				<p:inputText value="#{oddzialy.jednostkaKierujacaSluchacz}" style="width:95%"/>	
				   			<h:outputLabel>Stopień: </h:outputLabel>
				   				<p:selectOneMenu value="#{oddzialy.stopienSluchacz}" style="width:80%">
											<f:selectItems value="#{oddzialy.stopnie}"/>
								</p:selectOneMenu>
								   <p:selectBooleanCheckbox rendered="#{logowanie.poziomUprawnien eq 1 or (logowanie.poziomUprawnien eq 5)}" 
								   value="#{oddzialy.archbool}" itemLabel="arch."/>
						    <p:commandButton value="Szukaj" actionListener="#{oddzialy.findSluchacze}" update="pgOs,formSluchacze" />
			</p:panelGrid>
		</h:form>
	</div>
	
	<h:form id="formSluchacze" >
				<p:growl id="msgs" showDetail="false"/>
				<p:dataTable  rendered="#{oddzialy.wybranyPluton!=null or (oddzialy.sluchaczeSorted.size()>0)}" id="sluchacze" var="sluchacz" value="#{oddzialy.sluchaczeSorted}" editable="true" 
				style="text-align:center;margin-top:20px" rowKey="#{sluchacz.idS}" emptyMessage="Brak wyników" class="shadow" currentPageReportTemplate="{startRecord}-{endRecord} z {totalRecords} wpisów"
				 paginatorTemplate="{Exporters} {CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" paginator="true" 
				 rowsPerPageTemplate="20,30,50,100,200,300" rows="20" reflow="true">
							<f:facet name="{Exporters}">
								<h:outputLabel value="Sluchacze"/>
							
							  <h:commandLink style="float:left;position:relative" rendered="#{logowanie.poziomUprawnien eq 1}">
										<i  class="fa fa-file-excel" style="font-size:larger;color:#a66c20" title="export:xls"></i>
											<p:dataExporter type="xls" target="sluchacze" fileName="wydrukSluchaczexls"/>
						    	</h:commandLink>
						    	 <h:commandLink style="float:left;position:relative" rendered="#{logowanie.poziomUprawnien eq 1}">
                   					<i  class="fa fa-file" style="font-size:larger;color:gray" title="export-xml"></i>
                 				   <p:dataExporter type="xml" target="sluchacze" fileName="sluchaczexml"/>
                				</h:commandLink>
                				<h:commandLink style="float:left;position:relative" rendered="#{logowanie.poziomUprawnien eq 1}">
                   					<i  class="fa fa-file-pdf" style="font-size:larger;color:#42a5f5" title="export-pdf"></i>
                 				   <p:dataExporter type="pdf" target="sluchacze" fileName="sluchaczepdf" preProcessor="#{fileExportProcessor.preProcessPDF}" encoding="windows-1250"/>
                				</h:commandLink>
                					 <p:commandButton id="toggler" class="btn-sm" type="button" value="Kolumny" style="float:right" icon="fa fa-align-justify" />
        							<p:columnToggler datasource="sluchacze" trigger="toggler" />
								<div style="clear:both"></div>
							</f:facet>
							<p:column headerText="Id"  rendered="#{logowanie.poziomUprawnien eq 1 or (logowanie.poziomUprawnien eq 5)}" sortBy="#{sluchacz.idS}">
									<h:outputText  value="#{sluchacz.idS}"/>
							</p:column>
							<p:column headerText="N.d." sortBy="#{sluchacz.nrDziennik}" >
								<h:outputText  value="#{sluchacz.nrDziennik}"/>
							</p:column>
							<p:column headerText="Kadr." sortBy="#{sluchacz.idSluchacz}" >
								<h:outputText  value="#{sluchacz.idSluchacz}"/>
							</p:column>
							<p:column headerText="Stopień" sortBy="#{sluchacz.stopienSluchacz}" >
								<h:outputText  value="#{sluchacz.stopienSluchacz}"/>
							</p:column>
							<p:column headerText="Nazwisko" sortBy="#{sluchacz.nazwiskoSluchacz}">
								<h:outputText  value="#{sluchacz.nazwiskoSluchacz}"/>
							</p:column>
							<p:column headerText="Imię" sortBy="#{sluchacz.imieSluchacz}" >
								<h:outputText  value="#{sluchacz.imieSluchacz}"/>
							</p:column>
							<p:column  headerText="Komp." sortBy="#{sluchacz.pluton.kompania.nazwaKompania}">
								<h:outputText  value="#{sluchacz.pluton.kompania.nazwaKompania}"/>
							</p:column>
							<p:column  headerText="Plut." sortBy="#{sluchacz.pluton.nazwaPluton}">
								<h:outputText  value="#{sluchacz.pluton.nazwaPluton}"/>
							</p:column>
							<p:column  headerText="Szkol." sortBy="#{sluchacz.pluton.oznaczenieSzkolenia}">
								<h:outputText  value="#{sluchacz.pluton.oznaczenieSzkolenia}"/>
							</p:column>
							<p:column headerText="Jed. org." sortBy="#{sluchacz.jednostkaKierujaca}" >
								<h:outputText  value="#{sluchacz.jednostkaKierujaca}"/>
							</p:column>
							<p:column headerText="Pokój" sortBy="#{sluchacz.pokoj}" >
								<h:outputText  value="#{sluchacz.pokoj}"/>
							</p:column>
							<p:column headerText="Usunięty" sortBy="#{sluchacz.usuniety}">
								<h:outputText  value="#{sluchacz.usuniety}"/>
							</p:column>
							<p:column headerText="Data us." sortBy="#{sluchacz.dataRemove}">
										<h:outputText  value="#{sluchacz.dataRemove}">
											<f:convertDateTime pattern="dd-MM-yyyy"/>
										</h:outputText>
									
							</p:column>	
						</p:dataTable>
			</h:form>
			
			
			<p:chart type="donut" model="#{start.donutModel2}"
				styleClass="donutChar shadow" style="max-width:800px;max-height:550px;background:whitesmoke;margin:80px auto 150px auto"
				responsive="true"></p:chart>
		
	</p:panel>
</p:outputPanel>
</ui:define>
</ui:composition>	