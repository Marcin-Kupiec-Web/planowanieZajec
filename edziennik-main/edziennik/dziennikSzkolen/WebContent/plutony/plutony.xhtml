<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	template="/WEB-INF/templates/BasicTemplate.html">
<ui:define name="content">
<p:outputPanel deferred="true" >
	<p:panel style="border:none">
		<h:form id="formPlutonyLista" rendered="#{plutony.pluto.size()>0}">
			<p:dataTable var="plt" value="#{plutony.pluto}" widgetVar="plutsTable" id="dtPlut" tableStyle="width:100%!important"
			 paginator="true" rowsPerPageTemplate="20,50,100" rows="20" style="text-align:center" class="shadow">
				<f:facet name="header">Aktualne grupy</f:facet>
				<p:column style="text-align:center;width:17px;height:25px" priority="1" rendered="#{logowanie.poziomUprawnien le 4}">
								<p:rowToggler />
				</p:column>
				<p:column filterBy="#{plt.kompania.nazwaKompania}" sortBy="#{plt.kompania.nazwaKompania}" headerText="Komp." footerText="Komp." 
				filterMatchMode="contains">
					<h:outputText value="#{plt.kompania.nazwaKompania}" priority="1"/>
				</p:column>
				<p:column filterBy="#{plt.nazwaPluton}" sortBy="#{plt.nazwaPluton}" headerText="Plut." footerText="Plut." 
				filterMatchMode="contains" priority="1">
					<h:outputText value="#{plt.nazwaPluton}"/>
				</p:column>
				<p:column filterBy="#{plt.oznaczenieSzkolenia}" style="width:auto" sortBy="#{plt.oznaczenieSzkolenia}" headerText="Szkol." footerText="Szkol." 
				filterMatchMode="contains" priority="1">
					<h:outputText value="#{plt.oznaczenieSzkolenia}"/>
				</p:column>
				<p:column filterBy="#{customFormatDate.formatDat(plt.terminOd)}" sortBy="#{plt.terminOd}" headerText="Od" footerText="Od" 
				filterMatchMode="contains" priority="1">
					<h:outputText value="#{customFormatDate.formatDat(plt.terminOd)}"/>
				</p:column>
				<p:column filterBy="#{customFormatDate.formatDat(plt.terminDo)}" sortBy="#{plt.terminDo}" headerText="Do" footerText="Do" 
				filterMatchMode="contains" priority="1" style="width:autoro">
					<h:outputText value="#{customFormatDate.formatDat(plt.terminDo)}"/>
				</p:column>
				<p:column priority="3" filterBy="#{plt.sluchaczes.size()}" sortBy="#{plt.sluchaczes.size()}" headerText="L.os." footerText="L.os." 
						filterMatchMode="contains">
					<h:outputText value="#{plt.sluchaczes.stream().filter(sl->sl.usuniety eq 'NIE').count()}"/>
				</p:column>
				<p:column  headerText="F" footerText="F"   priority="4" rendered="#{logowanie.poziomUprawnien le 4}">
					<h:commandLink action="#{plutony.goPlutonZajecia(plt,'../zajecia/frekwencja.xhtml','i=2','subPage=frekwencja')}" style="background:white;border:1px solid lightgray;padding:3px;border-radius:15px"> 
       							<i class="fa fa-users-cog" style="color: #469ece"></i>
       				</h:commandLink>
				</p:column>
				<p:column  headerText="T" footerText="T"  priority="4">
					<h:commandLink action="#{plutony.goPlutonZajecia(plt,'../zajecia/tematy.xhtml','i=2','subPage=tematy')}" style="background:white;border:1px solid lightgray;padding:3px;border-radius:15px"> 
       							<i class="fa fa-tasks" style="color: #469ece"></i>
       				</h:commandLink>
				</p:column>
				<p:column  headerText="O" footerText="O"   priority="4" rendered="#{logowanie.poziomUprawnien le 4}">
					<h:commandLink action="#{plutony.goPlutonZajecia(plt,'../zajecia/oceny.xhtml','i=2','subPage=oceny')}" style="background:white;border:1px solid lightgray;padding:3px;border-radius:15px"> 
       							<i class="fa fa-balance-scale" style="color: #469ece"></i>
       				</h:commandLink>
				</p:column>
				<p:rowExpansion>
								<p:dataTable id="plutTableRowExpId" var="sluch" value="#{plt.sluchaczes}" emptyMessage="Brak uczniów" reflow="true" 
								rowStyleClass="#{sluch.usuniety=='TAK' ? 'usunietyRow' : ''}"
								 sortBy="#{sluch.nrDziennik}" style="width:100%" rendered="#{logowanie.poziomUprawnien le 4}">
									<p:column headerText="Nr." style="width:30px">
										<h:outputText value="#{sluch.nrDziennik}" />
									</p:column>
									<p:column headerText="Nazwisko" style="text-align:left;font-weight:bold;text-decoration:#{sluch.usuniety=='TAK' ? 'line-through' : ''}">
										<h:outputText value="#{sluch.nazwiskoSluchacz}" />
									</p:column>
									<p:column headerText="Imię" style="text-align:left;text-decoration:#{sluch.usuniety=='TAK' ? 'line-through' : ''}">
										<h:outputText value="#{sluch.imieSluchacz}" />
									</p:column>
									<p:column headerText="Kadrowy" style="width:100px;text-decoration:#{sluch.usuniety=='TAK' ? 'line-through' : ''}">
										<h:outputText value="#{sluch.idSluchacz}" />
									</p:column>
									<p:column headerText="Jednostka" style="text-align:left;text-decoration:#{sluch.usuniety=='TAK' ? 'line-through' : ''}">
										<h:outputText value="#{sluch.jednostkaKierujaca}" />
									</p:column>
									<p:column headerText="Komentarz" style="text-align:left">
										<h:outputText value="Usunięto: " rendered="#{sluch.usuniety=='TAK'}"/>
										<h:outputText value="#{sluch.dataRemove}" rendered="#{sluch.usuniety=='TAK'}">
											<f:convertDateTime pattern="dd-MM-yyyy"/>
										</h:outputText>
										<h:outputText value=" (#{nameUser.user(sluch.userRemove)})" rendered="#{sluch.usuniety=='TAK'}"/>
									</p:column>
								</p:dataTable>
				</p:rowExpansion>
			</p:dataTable>
			<p:blockUI block="dtPlut" trigger="dtPlut" /> 
		</h:form>
	</p:panel>
</p:outputPanel>
</ui:define>
	</ui:composition>	