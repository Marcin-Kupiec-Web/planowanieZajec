
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	template="/WEB-INF/templates/BasicTemplate.html">
	<ui:define name="styleCSS"><h:outputStylesheet name="css/planZajec.css" /></ui:define>	
		<ui:define name="content" >
		<h:panelGroup  rendered="#{poziomUprawnien eq 1 or (poziomUprawnien eq 5) or (poziomUprawnien eq 6)}">

				<!-- dialog do dodawania nowych zakładów -->
		<p:dialog header="Rejestracja sali dydaktycznej" id="rsd" widgetVar="dlgRejestracjaSala"  modal="true"  appendTo="@(body)" style="background:white;">
		<p:ajax event="close" update="rsd"  resetValues="true" />
				<h:form style="text-align:center" id="dialogFormSale">
						<h:panelGrid columns="4" >
							<h:outputLabel>Nazwa:</h:outputLabel>
							 		 <p:inputText value="#{sales.nazwaSali}" />
							<h:outputLabel value="Zkład:"/>
										<p:selectCheckboxMenu id="multiZaklad" value="#{sales.selectedZaklad}" label="Zakłady" multiple="true" filter="true"
																			filterMatchMode="startWith" panelStyle="width:250px" required="true">
													<f:selectItems value="#{sales.selectedZakladListString}"/>
										</p:selectCheckboxMenu>
								<h:outputLabel value="Specjalizacja:"/>
										<p:selectCheckboxMenu id="multiSpecjal" value="#{sales.selectedSpecjal}" label="Specjalizacje" multiple="true" filter="true"
																			filterMatchMode="startWith" panelStyle="width:250px" required="true">
													<f:selectItems value="#{sales.selectedSpecjalListString}"/>
										</p:selectCheckboxMenu>
							<h:outputLabel >Komentarz</h:outputLabel>
									 	 <p:inputTextarea value="#{sales.komentarzDoSali}"/>
						</h:panelGrid>
						<p:commandButton  action="#{sales.addSala}" value="Zapisz" icon="ui-icon-calculator" update=":formSale, dialogFormSale" style="margin:20px;width:90%;padding:5px"/>
				</h:form>	
		</p:dialog>
						        
	<h:form id="formSale" >
				<p:growl id="msgs" showDetail="false"/>
				<p:dataTable id="sale" var="sale" value="#{sales.wszystkieSale}" editable="true" style="text-align:center;width:90%;margin:auto" 
				rowKey="#{sale.idSale}" class="shadow my-tab-hover my-tab">
							<f:facet name="header">
									<h:commandLink style="float:left;position:relative;top:5px" id="rendExp" rendered="#{!sales.edycjaTabeli}">
											<i  class="fa fa-file-excel" style="font-size:larger;color:#a66c20"></i>
											<p:dataExporter type="xls" target="sale" fileName="wydrukiSale"/>
									</h:commandLink>
        								<h:outputLabel value="Sale" style="position:relative;top:5px"/>
        										
										<p:commandButton type="button" icon="ui-icon-calculator" value="Dodaj" rendered="#{poziomUprawnien eq 1 or (poziomUprawnien eq 6)}" style="float:right" onclick="PF('dlgRejestracjaSala').show();"/>
									
									<p:selectBooleanButton value="#{sales.edycjaTabeli}" onLabel="Edycja" offLabel="Edycja" onIcon="fa fa-check" offIcon="fa fa-times" style="float:right;margin-right:10px">
										<p:ajax update=":formSale:msgs,:formSale:sale" listener="#{sales.rendExpTab()}"/>
									</p:selectBooleanButton>
									
								<div style="clear:both"></div>
							</f:facet>
							<p:ajax event="rowEdit" listener="#{sales.onRowEdit}" update=":formSale:msgs"/>
							<p:column headerText="Id" style="width:70px" rendered="#{poziomUprawnien eq 1 or (poziomUprawnien eq 6)}" sortBy="#{sale.idSale}">
									<h:outputText  value="#{sale.idSale}"/>
							</p:column>
							<p:column headerText="Nazwa" sortBy="#{sale.nazwa}" style="text-align:left">
								<p:cellEditor>
									<f:facet name="output"><h:outputText  value="#{sale.nazwa}"/></f:facet>
									<f:facet name="input"><p:inputText  value="#{sale.nazwa}" required="true"  /></f:facet>
								</p:cellEditor>
							</p:column>
										<p:column headerText="Zaklad" sortBy="#{sales.zakladToString(sale.zaklads)}" id="saleZaklady" style="text-align:left">
																<p:cellEditor>
																	<f:facet name="output">
																		<h:outputText value="#{sales.zakladToString(sale.zaklads)}"/>
																	</f:facet>
																	<f:facet name="input">
																			<p:selectCheckboxMenu id="multiZaklad"  value="#{sales.selectedZaklad}" label="Zakłady" multiple="true" filter="true"
																			filterMatchMode="startWith" panelStyle="width:250px" required="true">
																					<f:selectItems value="#{sales.selectedZakladListString}"/>
																			</p:selectCheckboxMenu>
																	</f:facet>
																</p:cellEditor>
														</p:column>
															<p:column headerText="Specjalizacja" sortBy="#{sales.specjalToString(sale.specjalizacjas)}" style="text-align:left">
																<p:cellEditor>
																	<f:facet name="output" >
																		<h:outputText value="#{sales.specjalToString(sale.specjalizacjas)}"/>
																	</f:facet>
																	<f:facet name="input">
																		<p:selectCheckboxMenu id="multiSpecjal" value="#{sales.selectedSpecjal}" label="Specjalizacje" multiple="true" filter="true"
																						filterMatchMode="startWith" panelStyle="width:250px" required="true">
																				<f:selectItems value="#{sales.selectedSpecjalListString}"/>
																	</p:selectCheckboxMenu>
																</f:facet>
																</p:cellEditor>
															</p:column>
							<p:column headerText="Komentarz" sortBy="#{sale.komentarz}" style="text-align:left">
								<p:cellEditor>
									<f:facet name="output"><h:outputText  value="#{sale.komentarz}"/></f:facet>
									<f:facet name="input"><p:inputTextarea  value="#{sale.komentarz}" /></f:facet>
								</p:cellEditor>
							</p:column>
				
							<p:column style="width:55px;text-align:center" rendered="#{(poziomUprawnien eq 1 or (poziomUprawnien eq 6)) and (sales.edycjaTabeli)}" >
							<f:facet name="header"><i  class="fa fa-eraser"></i></f:facet>
							<p:commandButton icon="fa fa-cut"  actionListener="#{sales.remove(sale)}" update="@form" class="buttDelete btn-sm" process="@this">
									<p:confirm  header=" Uwaga, próbujesz usunac wpis!" message=" Czy potwierdzasz? " />
							</p:commandButton>
							</p:column>
							<p:column style="width:55px;text-align:center" rendered="#{(poziomUprawnien eq 1 or (poziomUprawnien eq 6)) and (sales.edycjaTabeli)}">
							<f:facet name="header"><i  class="fa fa-edit"></i></f:facet>
								<p:rowEditor />
							</p:column>
						</p:dataTable>
						<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
      							  <p:commandButton value="Tak" type="button" styleClass="ui-confirmdialog-yes bg-danger" icon="fa fa-check" />
       							  <p:commandButton value="Nie" type="button" styleClass="ui-confirmdialog-no bg-primary" icon="fa fa-times" />
   						</p:confirmDialog>  
			</h:form>
	</h:panelGroup>
	 </ui:define>
	<ui:define name="footer">
	</ui:define>
	
</ui:composition>

