
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	template="/WEB-INF/templates/BasicTemplate.html">
	<h:outputScript library="js" name="BasicTemplate.js" />
	<ui:define name="leftPane">
	</ui:define>
	<ui:define name="content" >
	<h:panelGroup >

		
	<h:form id="formUsers">
			<p:growl id="msgs" showDetail="true" autoUpdate="true"/>
				<p:dataTable   id="users" var="users" value="#{userManager.ul}" 
				widgetVar="usersTable" emptyMessage="Brak wyników" 
				class="my-tab-hover"
				editable="true" rowStyleClass="#{users.zablokowany eq 'TAK' ? 'zablokowanyRow' : ''}"  paginator="true" rows="15"
				 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
				  rowsPerPageTemplate="15,20,50,100,150" rowKey="#{users.idUsers}" >
				<f:facet name="header">
				<span style="position:relative;top:5px">Zarejestrowani użytkownicy</span>
				<p:commandButton icon="fa fa-user" value="Dodaj" style="float:right" 
								update=":formUsersDetail:userDetail" actionListener="#{userManager.rowSelectedUser(null)}" 
             					oncomplete="PF('userDialog').show()" />
				
				 <p:commandButton id="toggler" type="button" value="Kolumny" style="float:right" icon="fa fa-align-justify" />
        		<p:columnToggler datasource="users" trigger="toggler" />
				<div style="clear:both" ></div>
				</f:facet>
					<p:column filterBy="#{users.idUsers}"  sortBy="#{users.idUsers}"  headerText="Id" footerText="Id"  
					styleClass="columnAlignCenter" style="width:65px" priority="6">
						<h:outputText value="#{users.idUsers}" />
					</p:column>
					<p:column filterBy="#{users.nazwiskoUsers}" sortBy="#{users.nazwiskoUsers}" priority="9"
					filterValue="#{userManager.filterValues['users.nazwiskoUsers']}"  headerText="Nazwisko" footerText="Nazwisko" filterMatchMode="contains">
							<h:outputText value="#{users.nazwiskoUsers}" />
					</p:column>
					<p:column filterBy="#{users.imieUsers}" filterValue="#{userManager.filterValues['users.imieUsers']}" 
					sortBy="#{users.imieUsers}" headerText="Imię" footerText="Imię" filterMatchMode="contains" priority="10">
						<h:outputText value="#{users.imieUsers}" />
					</p:column>
					<p:column filterBy="#{users.loginUsers}" filterValue="#{userManager.filterValues['users.loginUsers']}" headerText="Login" footerText="Login" 
					sortBy="#{users.loginUsers}" styleClass="columnAlignCenter" priority="1">
								<h:outputText value="#{users.loginUsers}" />
					</p:column>
					<p:column headerText="Zaklad" sortBy="#{users.zakladToString}" priority="11"
					filterBy="#{users.zakladToString}" filterValue="#{userManager.filterValues['users.zaklady']}" filterMatchMode="contains">
								<h:outputText value="#{users.zakladToString}" />
					</p:column>
					<p:column headerText="Specjalizacja" sortBy="#{users.specjalizacjaToString}" filterBy="#{users.specjalizacjaToString}" 
							filterValue="#{userManager.filterValues['users.']}" filterMatchMode="contains">
										<h:outputText value="#{users.specjalizacjaToString}" />																
					</p:column>
					<p:column filterBy="#{users.statusUsers}" filterValue="#{userManager.filterValues['users.statusUsers']}" priority="2"
					sortBy="#{users.statusUsers}"  headerText="Status" footerText="Status" styleClass="columnAlignCenter"  filterMatchMode="contains">
						<h:outputText value="#{users.statusUsers}" />
					</p:column>
					<p:column filterBy="#{users.poziomUprawnien}" filterValue="#{userManager.filterValues['users.poziomUprawnien']}" priority="3" 
					sortBy="#{users.poziomUprawnien}" headerText="Upr." footerText="Upr." styleClass="columnAlignCenter">
						<h:outputText value="#{users.poziomUprawnien}" />
					</p:column>
						<p:column sortBy="#{users.ostatnieLogowanie}" headerText="Ostatnie log." footerText="Ostatnie log."  priority="12"
						styleClass="columnAlignCenter" style="width:110px" filterStyle="width:90%;margin:auto" filterMatchMode="contains">
						<h:outputText value="#{users.ostatnieLogowanie}" />
					</p:column>
					<p:column sortBy="#{users.zmianaHasla}"  headerText="Zmiana hasła" footerText="Zmiana hasła"  styleClass="columnAlignCenter" 
					style="width:115px" filterStyle="width:90%;margin:auto" filterMatchMode="contains" priority="4">
							<h:outputText value="#{users.zmianaHasla}" >
								<f:convertDateTime pattern="yyyy-MM-dd"/>
							</h:outputText>
					</p:column>
						<p:column filterBy="#{users.zablokowany}"  filterValue="#{userManager.filterValues['users.zablokowany']}" sortBy="#{users.zablokowany}" 
						 headerText="Blok." footerText="Blok."  styleClass="columnAlignCenter"  filterStyle="width:90%;margin:auto" priority="5">
						<h:outputText value="#{users.zablokowany}" />
							
					</p:column>
					 <p:column sortBy="#{users.errLog}"  headerText="B.h" footerText="B.h"  styleClass="columnAlignCenter"  
					 filterStyle="width:90%;margin:auto" filterMatchMode="contains" priority="6">
						
							<h:outputText value="#{users.errLog}" />
							
					</p:column>
				<p:column style="width:35px" headerText="Usuń" footerText="Usuń">
							<p:commandButton icon="fa fa-cut" class="buttDelete btn-sm" disabled="#{users.zablokowany!='TAK' or (users.usuniety) }" 
							actionListener="#{userManager.del}" update="@form"
						     oncomplete="PF('usersTable').filter()">
							<f:attribute name="removeRow" value="#{users}" />
							<p:confirm  header=" Uwaga, próbujesz usunąć konto!" message=" Czy potwierdzasz? " /> 
						</p:commandButton>
						<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
					        <p:commandButton value="Tak" type="button" styleClass="ui-confirmdialog-yes bg-danger" icon="fa fa-check" />
					        <p:commandButton value="Nie" type="button" styleClass="ui-confirmdialog-no bg-primary" icon="fa fa-times" />
					    </p:confirmDialog>
					</p:column>
					
					<p:column style="width:35px" headerText="Edyt." footerText="Edyt.">
						<p:rowEditor />
				</p:column>
					
		  <p:column style="width:56px;text-align: center" headerText="Akcja" footerText="Akcja" priority="6">
             <p:commandButton update=":formUsersDetail:userDetail" actionListener="#{userManager.rowSelectedUser(users)}" 
             oncomplete="PF('userDialog').show()" icon="fa fa-search" title="View" />
           
        </p:column>
	  </p:dataTable>
	</h:form>
					
<p:dialog  header="Uzytkownik" id="usDial" widgetVar="userDialog" modal="true" appendTo="@(body)" showEffect="fade" hideEffect="fade" resizable="false">
<p:ajax event="close" update="usDial" resetValues="true" />
    <h:form id="formUsersDetail">	
          
        <p:outputPanel id="userDetail" >
            <p:panelGrid  columns="4" rendered="#{not empty userManager.selectedUser}">
                <f:facet name="header" >
                <div style="float:left">
                   <span class="fa fa-user" style="font-size:25px;color:gray"></span>
                   <h:outputText value=" Id: #{userManager.selectedUser.idUsers}" rendered="#{userManager.selectedUser.idUsers>0}"/>
                   </div>
                </f:facet>        
                <h:outputText value="Imię:" />
                <p:inputText value="#{userManager.selectedUser.imieUsers}" required="true"/>
 
                <h:outputText value="Nazwisko:" />
                 <p:inputText value="#{userManager.selectedUser.nazwiskoUsers}" required="true"/>
             
                <h:outputText value="Login:" />
                 <p:inputText value="#{userManager.selectedUser.loginUsers}" required="true"/>
                 <h:outputText value="Hasło:" />
                 <p:outputPanel>
                 <p:password value="#{userManager.haslo}" autocomplete="one-time-code" label="Haslo" /><br />
				<p:password value="#{userManager.passRepeat}" autocomplete="one-time-code" label="Powtorzone haslo" style="margin-top:5px"/>
                 </p:outputPanel>
           		 <h:outputText value="Zakład:" />
					<p:selectCheckboxMenu id="multiZaklad"  value="#{userManager.selectedZaklad}"  multiple="true" filter="true"
							filterMatchMode="startWith" panelStyle="width:250px" required="true">
							<f:selectItems value="#{userManager.selectedZakladListString}"/>
					</p:selectCheckboxMenu>
				<h:outputText value="Specjalizacja:" />
				<p:selectCheckboxMenu id="multiSpecjal" value="#{userManager.selectedSpecjal}"  multiple="true" filter="true"
							filterMatchMode="startWith" panelStyle="width:250px" required="true">
							<f:selectItems value="#{userManager.selectedSpecjalListString}"/>
				</p:selectCheckboxMenu>		
				 <h:outputText value="Status:" />										
				<p:inputText value="#{userManager.selectedUser.statusUsers}" title="Status" required="true"/>		
				<h:outputText value="Poziom uprawnień:" />
						<p:selectOneMenu value="#{userManager.selectedUser.poziomUprawnien}" >
									<f:selectItem itemLabel="8" itemValue="8"/>
									<f:selectItem itemLabel="7" itemValue="7"/>
									<f:selectItem itemLabel="6" itemValue="6"/>
									<f:selectItem itemLabel="5" itemValue="5"/>
									<f:selectItem itemLabel="4" itemValue="4"/>
									<f:selectItem itemLabel="3" itemValue="3"/>
									<f:selectItem itemLabel="2" itemValue="2"/>
									<f:selectItem itemLabel="1" itemValue="1"/>
						</p:selectOneMenu>		
		    <h:outputText value="Zmiana hasła:" />		
		     <p:calendar id="zmianaHasla" value="#{userManager.selectedUser.zmianaHasla}" pattern="yyyy-MM-dd" locale="pl"/>	
		      <h:outputText value="Zablokowany:" />	
		     <p:selectOneMenu value="#{userManager.selectedUser.zablokowany}" >
									<f:selectItem itemLabel="TAK" itemValue="TAK"/>
									<f:selectItem itemLabel="NIE" itemValue="NIE"/>
			</p:selectOneMenu>
			<h:outputText value="Błędne logowania:" />	
			<p:inputText value="#{userManager.selectedUser.errLog}" style="width:40%!important" required="true"/>		
			<h:outputText value="" />	
			<h:outputText value="" />						
            </p:panelGrid>
            <p:commandButton value="zapisz" update=":formUsers, formUsersDetail" actionListener="#{userManager.addSaveUser}"  icon="fa fa-save" 
            style="margin:10px 0 10px 0; width:100%"/>
            
        </p:outputPanel>
        </h:form>
 </p:dialog>
		
			<p:spacer style="height:45px"/>
			<p:panelGrid style="width:50%">
			<f:facet name="header">
				<p:row>
					<p:column colspan="3">Poziom uprawnień</p:column>
				</p:row>
				<p:row>
					<p:column>Wartość</p:column>
					<p:column>Funkcja</p:column>
					<p:column>Komentarz</p:column>
				</p:row>
			</f:facet>
				<p:row>
					<p:column style="text-align:center">1</p:column>
					<p:column>Administrator</p:column>
					<p:column></p:column>
				</p:row>
				<p:row>
					<p:column style="text-align:center">2</p:column>
					<p:column>Dowódca</p:column>
					<p:column></p:column>
				</p:row>
				<p:row>
					<p:column style="text-align:center">3</p:column>
					<p:column>Nauczyciel</p:column>
					<p:column></p:column>
				</p:row>
				<p:row>
					<p:column style="text-align:center">4</p:column>
					<p:column>Kierownictwo</p:column>
					<p:column></p:column>
				</p:row>
				<p:row>
					<p:column style="text-align:center">5</p:column>
					<p:column>Organizacja</p:column>
					<p:column></p:column>
				</p:row>
					<p:row>
					<p:column style="text-align:center">6</p:column>
					<p:column>Planowanie</p:column>
					<p:column></p:column>
				</p:row>
				<p:row>
					<p:column style="text-align:center">7</p:column>
					<p:column>Słuchacz</p:column>
					<p:column></p:column>
				</p:row>
				<p:row>
					<p:column style="text-align:center">8</p:column>
					<p:column>Pozostali</p:column>
					<p:column></p:column>
				</p:row>
			</p:panelGrid>
		</h:panelGroup>
			<p:spacer style="height:45px"/>
		</ui:define>
	
	<ui:define name="footer">
	</ui:define>
</ui:composition>






	




